import csv

train = open(r'pre_train.csv')
test = open(r'pre_test.csv')
byte = ['0', '1', '2', '3', '4', '5', '6', '7', '8',
        '9', 'A', 'B', 'C', 'D', 'E', 'F']
features = [i + j for i in byte for j in byte]
features2 = [feat+'r' for feat in features]

rows = []
rows2 = []
for t, row in enumerate(train):
    row = row.strip().split(',')
    rows.append(row)
        
for t, row in enumerate(test):
    row = row.strip().split(',')
    rows2.append(row)

for k, row in enumerate(rows):
    if k == 0:
        row.extend(features2)
    if k >= 1:
        Id = row[0]
        Class = row[1]
        values = row[2:]
        summation = 0
        newRow = row[:]
        for i in values:
            summation += int(i)
        if summation == 0:
            row.extend([0] * (len(row) - 2))
            continue
        for t, j in enumerate(row):
            if t >= 2:
                newRow.append(float(j) / summation)
        rows[k] = newRow[:]

for k, row in enumerate(rows2):
    if k == 0:
        row.extend(features2)
    if k >= 1:
        Id = row[0]
        values = row[1:]
        summation = 0
        newRow = row[:]
        for i in values:
            summation += int(i)
        if summation == 0:
            row.extend([0] * (len(row) - 1))
            continue
        for t, j in enumerate(row):
            if t >= 1:
                newRow.append(float(j) / summation)
        rows2[k] = newRow[:]

predictions_file = open("tran_train.csv", "wb")
open_file_object = csv.writer(predictions_file)
open_file_object.writerows(rows)
predictions_file.close()

predictions_file = open("tran_test.csv", "wb")
open_file_object = csv.writer(predictions_file)
open_file_object.writerows(rows2)
predictions_file.close()
