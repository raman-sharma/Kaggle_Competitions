import re
import csv

train = open(r'trainLabels.csv')
test = open(r'sampleSubmission.csv')
byte = ['0', '1', '2', '3', '4', '5', '6', '7', '8',
        '9', 'A', 'B', 'C', 'D', 'E', 'F']
features = [i + j for i in byte for j in byte]

def readFile(filename):
    openfile = open(filename)
    rows = []
    for row in openfile:
        rows.append(row)

    allBytes = []
    for i in rows:
        byteList = i.strip().split()
        byteList = byteList[1:]
        allBytes += byteList

    bytesDict = {}
    for i in allBytes:
        if i not in bytesDict:
            bytesDict[i] = 0
        bytesDict[i] += 1

    if '??' in bytesDict:
        del bytesDict['??']

    for feat in features:
        if feat not in bytesDict:
            bytesDict[feat] = 0
    
    return bytesDict

rows = []
for row in train:
    rows.append(row)
rows = rows[1:]

f = open(r'pre_train.csv', 'wb')
open_file_object = csv.writer(f)
header = ['Id', 'Class']
header.extend(features)
open_file_object.writerow(header)

for t, i in enumerate(rows):
    Id, Class = i.strip().split(',')
    Id = re.compile('(\w+)').findall(Id)[0]
    filename = 'train\\' + Id + '.bytes'
    bytesDict = readFile(filename)
    content = []
    content.append(Id)
    content.append(Class)
    content.extend([bytesDict[feat] for feat in features])
    open_file_object.writerow(content)
    print t

f.close()

rows = []
for row in test:
    rows.append(row)
rows = rows[1:]

f = open(r'pre_test.csv', 'wb')
open_file_object = csv.writer(f)
header = ['Id']
header.extend(features)
open_file_object.writerow(header)

for t, i in enumerate(rows):
    Id = i.strip().split(',')[0]
    Id = re.compile('(\w+)').findall(Id)[0]
    filename = 'test\\' + Id + '.bytes'
    bytesDict = readFile(filename)
    content = []
    content.append(Id)
    content.extend([bytesDict[feat] for feat in features])
    open_file_object.writerow(content)
    print t

f.close()
